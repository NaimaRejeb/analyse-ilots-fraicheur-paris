---
title: "Analyse Statistique"
subtitle: "Statistiques descriptives et analyses avanc√©es"
format:
  html:
    theme: cosmo
    toc: true
    code-fold: true
    embed-resources: false
---

# üìà Statistiques Descriptives

::: {.callout-note}
## Donn√©es utilis√©es
Cette analyse utilise les **donn√©es nettoy√©es** issues du pr√©traitement (520 lignes apr√®s suppression des 28 doublons).
:::

## Chargement des donn√©es

```{r echo=TRUE, message=FALSE, warning=FALSE}
# Charger les donn√©es nettoy√©es si disponibles, sinon depuis l'API
if (file.exists("data/donnees_nettoyees.csv")) {
  donnees <- read.csv("data/donnees_nettoyees.csv", encoding = "UTF-8", stringsAsFactors = FALSE)
  cat("‚úÖ Donn√©es nettoy√©es charg√©es depuis le fichier local\n")
} else {
  # URL du dataset Open Data Paris (fallback)
  url <- "https://opendata.paris.fr/api/explore/v2.1/catalog/datasets/ilots-de-fraicheur-equipements-activites/exports/csv"
  donnees <- read.csv2(url, encoding = "UTF-8", stringsAsFactors = FALSE)
  cat("‚ö†Ô∏è Donn√©es charg√©es depuis l'API (non pr√©trait√©es)\n")
}

# Aper√ßu
cat("\nüìä APER√áU DES DONN√âES\n")
cat("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n")
cat("Nombre d'√Ælots de fra√Æcheur:", nrow(donnees), "\n")
cat("Nombre de variables:", ncol(donnees), "\n")
```

## R√©partition par type d'√©quipement

```{r echo=TRUE}
# Calculer les statistiques
type_table <- table(donnees$type)
type_df <- data.frame(
  Type = names(type_table),
  Nombre = as.numeric(type_table),
  Pourcentage = round(as.numeric(type_table) / sum(type_table) * 100, 1)
)
type_df <- type_df[order(-type_df$Nombre), ]

# Afficher le tableau
print(type_df)
```

### Visualisation

```{r echo=TRUE, fig.height=6, fig.width=10}
# Graphique en barres
par(mar = c(5, 12, 4, 2))
barplot(head(type_df$Nombre, 10), 
        names.arg = head(type_df$Type, 10),
        horiz = TRUE, 
        las = 1,
        col = rainbow(10),
        main = "Top 10 des types d'√©quipements",
        xlab = "Nombre d'√©quipements")
```

## R√©partition par arrondissement

```{r echo=TRUE}
# Statistiques par arrondissement
arrd_table <- table(donnees$arrondissement)
arrd_df <- data.frame(
  Arrondissement = names(arrd_table),
  Nombre = as.numeric(arrd_table),
  Pourcentage = round(as.numeric(arrd_table) / sum(arrd_table) * 100, 1)
)
arrd_df <- arrd_df[order(-arrd_df$Nombre), ]

# Afficher le top 10
print(head(arrd_df, 10))
```

### Visualisation

```{r echo=TRUE, fig.height=7, fig.width=10}
arrd_sorted <- sort(table(donnees$arrondissement))

par(mar = c(5, 5, 4, 2))
barplot(arrd_sorted, 
        main = "Nombre d'√Ælots de fra√Æcheur par arrondissement",
        xlab = "Arrondissement",
        ylab = "Nombre d'√Ælots",
        col = "steelblue",
        las = 2)
```

## Accessibilit√©

```{r echo=TRUE}
# Statistiques d'accessibilit√©
payant_table <- table(donnees$payant)
payant_df <- data.frame(
  Acces = names(payant_table),
  Nombre = as.numeric(payant_table),
  Pourcentage = round(as.numeric(payant_table) / sum(payant_table) * 100, 1)
)

print(payant_df)
```

### Graphique

```{r echo=TRUE, fig.height=6, fig.width=8}
# Camembert
pie(payant_table, 
    main = "Accessibilit√© des √Ælots de fra√Æcheur",
    col = c("gray80", "#2ecc71", "#e74c3c"),
    labels = paste(names(payant_table), "\n", 
                   round(payant_table/sum(payant_table)*100, 1), "%"))
```

# üîç Analyses Avanc√©es

## Analyse crois√©e

```{r echo=TRUE}
# Top 8 types
top8_types <- head(names(sort(table(donnees$type), decreasing = TRUE)), 8)
donnees_top8 <- donnees[donnees$type %in% top8_types, ]

# Tableau crois√©
table_croisee <- table(donnees_top8$type, donnees_top8$payant)
print(table_croisee)
```

## R√©sum√© statistique

```{r echo=TRUE}
resume <- data.frame(
  Indicateur = c(
    "Nombre total",
    "Types diff√©rents",
    "Type principal",
    "Arrondissement top",
    "Taux gratuit"
  ),
  Valeur = c(
    nrow(donnees),
    length(unique(donnees$type[donnees$type != ""])),
    names(sort(table(donnees$type), decreasing = TRUE))[1],
    names(sort(table(donnees$arrondissement), decreasing = TRUE))[1],
    paste0(round(sum(donnees$payant == "Non", na.rm = TRUE) / nrow(donnees) * 100, 1), "%")
  )
)

print(resume)
```

---

**Conclusion** : Paris dispose de 548 √Ælots de fra√Æcheur avec plus de 80% d'acc√®s gratuit.
